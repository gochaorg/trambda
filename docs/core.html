<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src/site/markdown/core.md at 2021-04-12
 | Rendered using Apache Maven Fluido Skin 1.8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>Trambda &#x2013; Ядро</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.8.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.8.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>trambda</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2021-04-12<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="intro.html" title="intro"><span class="none"></span>intro</a></li>
    <li><a href="plan.html" title="road map"><span class="none"></span>road map</a></li>
    <li class="active"><a href="#"><span class="none"></span>core</a></li>
    <li><a href="tcp.html" title="tcp"><span class="none"></span>tcp</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>&#x42f;&#x434;&#x440;&#x43e;</h1>
<p>&#x41e;&#x441;&#x43d;&#x43e;&#x432;&#x43d;&#x43e;&#x435; &#x44f;&#x434;&#x440;&#x43e;, &#x43c;&#x43e;&#x434;&#x443;&#x43b;&#x44c; - <code>trambda-core</code>.</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;dependency&gt;
    &lt;groupId&gt;xyz.cofe&lt;/groupId&gt;
    &lt;artifactId&gt;trambda-core&lt;/artifactId&gt;
    &lt;!-- &#x410;&#x43a;&#x442;&#x443;&#x430;&#x43b;&#x44c;&#x43d;&#x443;&#x44e; &#x432;&#x435;&#x440;&#x441;&#x438;&#x44e; &#x43b;&#x443;&#x447;&#x448;&#x435; &#x43f;&#x43e;&#x438;&#x441;&#x43a;&#x430;&#x442;&#x44c; 
           &#x43d;&#x430; https://oss.sonatype.org/
           &#x43d;&#x430; https://search.maven.org/ 
    --&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;
</pre></div></div>

<p>&#x417;&#x430;&#x434;&#x430;&#x447;&#x438; &#x43c;&#x43e;&#x434;&#x443;&#x43b;&#x44f;</p>
<ul>

<li>&#x41f;&#x43e;&#x43b;&#x443;&#x447;&#x438;&#x442;&#x44c; &#x431;&#x430;&#x439;&#x442;-&#x43a;&#x43e;&#x434; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x44b; &#x43f;&#x435;&#x440;&#x435;&#x434;&#x430;&#x43d;&#x43d;&#x43e;&#x439; &#x432; &#x43a;&#x430;&#x447;&#x435;&#x441;&#x442;&#x432;&#x435; &#x43f;&#x430;&#x440;&#x430;&#x43c;&#x435;&#x442;&#x440;&#x430;</li>
<li>(&#x414;&#x435;)&#x421;&#x435;&#x440;&#x438;&#x430;&#x43b;&#x438;&#x437;&#x430;&#x446;&#x438;&#x44f; &#x431;&#x430;&#x439;&#x442;-&#x43a;&#x43e;&#x434;&#x430;</li>
<li>&#x413;&#x435;&#x43d;&#x435;&#x440;&#x430;&#x446;&#x438;&#x44f; &#x43a;&#x43b;&#x430;&#x441;&#x441;&#x430; JVM &#x434;&#x43b;&#x44f; &#x441;&#x435;&#x440;&#x438;&#x430;&#x43b;&#x438;&#x437;&#x43e;&#x432;&#x430;&#x43d;&#x43d;&#x43e;&#x433;&#x43e; &#x43f;&#x440;&#x435;&#x434;&#x441;&#x442;&#x430;&#x432;&#x43b;&#x435;&#x43d;&#x438;&#x44f;</li>
<li>&#x424;&#x443;&#x43d;&#x43a;&#x446;&#x438;&#x438; &#x43f;&#x440;&#x43e;&#x432;&#x435;&#x440;&#x43a;&#x438; &#x431;&#x435;&#x437;&#x43e;&#x43f;&#x430;&#x441;&#x43d;&#x43e;&#x441;&#x442;&#x438; &#x431;&#x430;&#x439;&#x442;-&#x43a;&#x43e;&#x434;&#x430;</li>
</ul><section>
<h2><a name="a.D0.9F.D0.BE.D0.BB.D1.83.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B1.D0.B0.D0.B9.D1.82-.D0.BA.D0.BE.D0.B4.D0.B0_.D0.B8_.D0.B5.D0.B3.D0.BE_.D1.81.D0.B5.D1.80.D0.B8.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D1.8F"></a>&#x41f;&#x43e;&#x43b;&#x443;&#x447;&#x435;&#x43d;&#x438;&#x435; &#x431;&#x430;&#x439;&#x442;-&#x43a;&#x43e;&#x434;&#x430; &#x438; &#x435;&#x433;&#x43e; &#x441;&#x435;&#x440;&#x438;&#x430;&#x43b;&#x438;&#x437;&#x430;&#x446;&#x438;&#x44f;</h2>
<p>&#x414;&#x430;&#x43d;&#x43d;&#x43e;&#x439; &#x444;&#x443;&#x43d;&#x43a;&#x446;&#x438;&#x439; &#x437;&#x430;&#x43d;&#x438;&#x43c;&#x430;&#x435;&#x442;&#x441;&#x44f; &#x43a;&#x43b;&#x430;&#x441;&#x441; <code>xyz.cofe.trambda.AsmQuery</code>.</p>
<p>&#x414;&#x430;&#x43d;&#x43d;&#x44b;&#x439; &#x43a;&#x43b;&#x430;&#x441;&#x441; &#x440;&#x435;&#x430;&#x43b;&#x438;&#x437;&#x443;&#x435;&#x442; &#x438;&#x43d;&#x442;&#x435;&#x440;&#x444;&#x435;&#x439;&#x441; <code>xyz.cofe.trambda.Query&lt;ENV&gt;</code>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">/**
 * &#x41e;&#x431;&#x449;&#x438;&#x439; &#x438;&#x43d;&#x442;&#x435;&#x440;&#x444;&#x435;&#x439;&#x441; &#x434;&#x43b;&#x44f; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x430; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x44b; &#x43d;&#x430; &#x441;&#x435;&#x440;&#x432;&#x435;&#x440;&#x435;
 * @param &lt;ENV&gt; &#x421;&#x435;&#x440;&#x432;&#x438;&#x441; &#x43f;&#x440;&#x435;&#x434;&#x43e;&#x441;&#x442;&#x430;&#x432;&#x43b;&#x44f;&#x435;&#x43c;&#x44b;&#x439; &#x43d;&#x430; &#x441;&#x435;&#x440;&#x432;&#x435;&#x440;&#x435;
 */
public interface Query&lt;ENV&gt; {
    /**
     * &#x412;&#x44b;&#x437;&#x43e;&#x432; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x44b; &#x43d;&#x430; &#x441;&#x435;&#x440;&#x432;&#x435;&#x440;&#x435;
     * @param fn &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x430;
     * @param &lt;RES&gt; &#x421;&#x435;&#x440;&#x432;&#x438;&#x441; &#x43f;&#x440;&#x435;&#x434;&#x43e;&#x441;&#x442;&#x430;&#x432;&#x43b;&#x44f;&#x435;&#x43c;&#x44b;&#x439; &#x43d;&#x430; &#x441;&#x435;&#x440;&#x432;&#x435;&#x440;&#x435;
     * @return &#x440;&#x435;&#x437;&#x443;&#x43b;&#x44c;&#x442;&#x430;&#x442; &#x432;&#x44b;&#x447;&#x438;&#x441;&#x43b;&#x435;&#x43d;&#x438;&#x44f; &#x43d;&#x430; &#x441;&#x435;&#x440;&#x432;&#x435;&#x440;&#x435;
     */
    public &lt;RES&gt; RES apply( Fn&lt;ENV,RES&gt; fn );
}
</pre></div></div>

<p><code>Fn</code> - &#x42d;&#x442;&#x43e; &#x444;&#x443;&#x43d;&#x43a;&#x446;&#x438;&#x44f; &#x43e;&#x442; &#x43e;&#x434;&#x43d;&#x43e;&#x433;&#x43e; &#x43f;&#x430;&#x440;&#x430;&#x43c;&#x435;&#x442;&#x440;&#x430;:</p>

<div class="source">
<div class="source"><pre class="prettyprint">package xyz.cofe.trambda;

import java.io.Serializable;
import java.util.function.Function;

/**
 * &#x41b;&#x44f;&#x43c;&#x431;&#x434;&#x430; &#x43f;&#x435;&#x440;&#x435;&#x434;&#x430;&#x432;&#x430;&#x435;&#x43c;&#x430;&#x44f; &#x43d;&#x430; &#x441;&#x435;&#x440;&#x432;&#x435;&#x440;
 * @param &lt;A&gt; &#x422;&#x438;&#x43f; &#x441;&#x435;&#x440;&#x432;&#x438;&#x441;&#x430; &#x43a;&#x43e;&#x442;&#x43e;&#x440;&#x44b;&#x439; &#x434;&#x43e;&#x441;&#x442;&#x443;&#x43f;&#x435;&#x43d; &#x440;&#x430; &#x441;&#x435;&#x440;&#x432;&#x435;&#x440;&#x435;
 * @param &lt;Z&gt; &#x422;&#x438;&#x43f; &#x440;&#x435;&#x437;&#x443;&#x43b;&#x44c;&#x442;&#x430;&#x442;&#x430; &#x432;&#x43e;&#x437;&#x432;&#x440;&#x430;&#x449;&#x430;&#x435;&#x43c;&#x44b;&#x439; &#x441; &#x441;&#x435;&#x440;&#x432;&#x435;&#x440;&#x430;
 */
public interface Fn&lt;A,Z&gt; extends Serializable, Function&lt;A,Z&gt; {
    /**
     * &#x412;&#x44b;&#x437;&#x43e;&#x432; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x44b;
     * @param a &#x441;&#x435;&#x440;&#x432;&#x438;&#x441; &#x43f;&#x435;&#x440;&#x435;&#x434;&#x430;&#x432;&#x430;&#x435;&#x43c;&#x44b;&#x439; &#x432; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x443;
     * @return &#x440;&#x435;&#x437;&#x443;&#x43b;&#x44c;&#x442;&#x430;&#x442;&#x430; &#x432;&#x43e;&#x437;&#x432;&#x440;&#x430;&#x449;&#x430;&#x435;&#x43c;&#x44b;&#x439; &#x441; &#x441;&#x435;&#x440;&#x432;&#x435;&#x440;&#x430;
     */
    public Z apply(A a);
}
</pre></div></div>

<p>&#x414;&#x43b;&#x44f; &#x442;&#x43e;&#x433;&#x43e; &#x447;&#x442;&#x43e; &#x431;&#x44b; &#x43f;&#x43e;&#x43b;&#x443;&#x447;&#x438;&#x442;&#x44c; &#x431;&#x430;&#x439;&#x442;-&#x43a;&#x43e;&#x434; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x44b;, &#x43d;&#x435;&#x43e;&#x431;&#x445;&#x43e;&#x434;&#x438;&#x43c;&#x43e; &#x441;&#x43e;&#x437;&#x434;&#x430;&#x442;&#x44c; &#x43f;&#x43e;&#x442;&#x43e;&#x43c;&#x43a;&#x430; &#x43e;&#x442; <code>AsmQuery</code></p>

<div class="source">
<div class="source"><pre class="prettyprint">public class AsmQuery&lt;ENV&gt; implements Query&lt;ENV&gt; {
    ...
    /**
     * &#x421;&#x435;&#x440;&#x438;&#x430;&#x43b;&#x438;&#x437;&#x430;&#x446;&#x438;&#x44f; &#x438; &#x432;&#x44b;&#x437;&#x43e;&#x432; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x44b;
     * @param fn &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x430;
     * @param &lt;RES&gt; &#x440;&#x435;&#x437;&#x443;&#x43b;&#x44c;&#x442;&#x430;&#x442; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x430;
     * @return &#x440;&#x435;&#x437;&#x443;&#x43b;&#x44c;&#x442;&#x430;&#x442; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x430;
     */
    @Override
    public &lt;RES&gt; RES apply(Fn&lt;ENV, RES&gt; fn){
        ...
    }
    ...
    /**
     * &#x420;&#x435;&#x430;&#x43b;&#x438;&#x437;&#x430;&#x446;&#x438;&#x44f; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x430; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x44b;
     * @param fn &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x430;
     * @param sl &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x430; - &#x441;&#x435;&#x440;&#x438;&#x430;&#x43b;&#x438;&#x437;&#x430;&#x446;&#x438;&#x44f;
     * @param mdef &#x431;&#x430;&#x439;&#x442;-&#x43a;&#x43e;&#x434; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x44b;
     * @param &lt;RES&gt; &#x440;&#x435;&#x437;&#x443;&#x43b;&#x44c;&#x442;&#x430;&#x442; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x430;
     * @return &#x440;&#x435;&#x437;&#x443;&#x43b;&#x44c;&#x442;&#x430;&#x442; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x430;
     */
    protected &lt;RES&gt; RES call( Fn&lt;ENV, RES&gt; fn, SerializedLambda sl, MethodDef mdef ){
        return null;
    }
    ...
}
</pre></div></div>

<p>&#x42d;&#x442;&#x43e; &#x43a;&#x43b;&#x430;&#x441; &#x43f;&#x43e; &#x441;&#x443;&#x442;&#x438; &#x44f;&#x432;&#x43b;&#x44f;&#x435;&#x442;&#x441;&#x44f; &#x430;&#x431;&#x441;&#x442;&#x440;&#x430;&#x43a;&#x442;&#x43d;&#x44b;&#x43c;, &#x438; &#x434;&#x43b;&#x44f; &#x440;&#x435;&#x430;&#x43b;&#x438;&#x437;&#x430;&#x446;&#x438;&#x438; &#x43a;&#x43e;&#x43d;&#x435;&#x447;&#x43d;&#x43e;&#x439; &#x444;&#x443;&#x43d;&#x43a;&#x446;&#x438;&#x43e;&#x43d;&#x430;&#x43b;&#x44c;&#x43d;&#x43e;&#x441;&#x442;&#x438; &#x442;&#x440;&#x435;&#x431;&#x443;&#x435;&#x442;&#x441;&#x44f; &#x43f;&#x435;&#x440;&#x435;&#x43e;&#x43f;&#x440;&#x435;&#x434;&#x435;&#x43b;&#x438;&#x442;&#x44c; &#x43c;&#x435;&#x442;&#x43e;&#x434; <code>call(Fn, SerializedLambda, MethodDef)</code></p>
<p>&#x414;&#x430;&#x43d;&#x43d;&#x44b;&#x439; &#x43a;&#x43b;&#x430;&#x441;&#x441; &#x43f;&#x43e; &#x441;&#x443;&#x442;&#x438; &#x432;&#x44b;&#x43f;&#x43e;&#x43b;&#x43d;&#x44f;&#x435;&#x442; &#x441;&#x43b;&#x435;&#x434;&#x443;&#x44e;&#x449;&#x438;&#x435; &#x444;&#x443;&#x43d;&#x43a;&#x446;&#x438;&#x438;:</p>
<ul>

<li>&#x41c;&#x435;&#x442;&#x43e;&#x434;&#x430; <code>apply(Fn)</code> - &#x43f;&#x43e;&#x43b;&#x443;&#x447;&#x430;&#x435;&#x442; &#x431;&#x430;&#x439;&#x442; &#x43a;&#x43e;&#x434; fn</li>
<li>&#x41f;&#x43e;&#x43b;&#x443;&#x447;&#x435;&#x43d;&#x43d;&#x44b;&#x439; &#x431;&#x430;&#x439;&#x442; &#x43a;&#x43e;&#x434; &#x43f;&#x435;&#x440;&#x435;&#x434;&#x430;&#x435;&#x442; &#x432; <code>call(Fn, SerializedLambda, MethodDef)</code></li>
</ul>

<div class="source">
<div class="source"><pre class="prettyprint">AtomicReference&lt;MethodDef&gt; mdefRef = new AtomicReference&lt;&gt;();
var res = new AsmQuery&lt;IEnv&gt;(){
    @Override
    protected   RES call(Fn&lt;IEnv, RES&gt; fn, SerializedLambda sl, MethodDef mdef){
        // &#x421;&#x43e;&#x445;&#x440;&#x430;&#x43d;&#x435;&#x43d;&#x438;&#x435; &#x43f;&#x440;&#x435;&#x434;&#x441;&#x442;&#x430;&#x432;&#x43b;&#x435;&#x43d;&#x438;&#x44f; &#x431;&#x430;&#x439;&#x442; &#x43a;&#x43e;&#x434;&#x430;
        mdefRef.set(mdef);
        // ...
        return netClient.call(fn, sl, mdef);
    }
}.apply( env0 -&gt; 
    env0.getUsers().filter(
        u -&gt; u.getName().contains(&quot;Petrov&quot;)
    )
);
</pre></div></div>
<section>
<h3><a name="MethodDef"></a>MethodDef</h3>
<p><code>xyz.cofe.trambda.bc.MethodDef</code> - &#x42d;&#x442;&#x43e; &#x441;&#x435;&#x440;&#x438;&#x430;&#x43b;&#x438;&#x437;&#x43e;&#x432;&#x430;&#x43d;&#x43d;&#x43e;&#x435; &#x43f;&#x440;&#x435;&#x434;&#x441;&#x442;&#x430;&#x432;&#x43b;&#x435;&#x43d;&#x438;&#x435; &#x431;&#x430;&#x439;&#x442;-&#x43a;&#x43e;&#x434;&#x430;.</p></section></section><section>
<h2><a name="a.D0.93.D0.B5.D0.BD.D0.B5.D1.80.D0.B0.D1.86.D0.B8.D1.8F_.D0.BA.D0.BB.D0.B0.D1.81.D1.81.D0.B0_JVM_.D0.B4.D0.BB.D1.8F_.D1.81.D0.B5.D1.80.D0.B8.D0.B0.D0.BB.D0.B8.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D0.BE.D0.B3.D0.BE_.D0.BF.D1.80.D0.B5.D0.B4.D1.81.D1.82.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D1.8F"></a>&#x413;&#x435;&#x43d;&#x435;&#x440;&#x430;&#x446;&#x438;&#x44f; &#x43a;&#x43b;&#x430;&#x441;&#x441;&#x430; JVM &#x434;&#x43b;&#x44f; &#x441;&#x435;&#x440;&#x438;&#x430;&#x43b;&#x438;&#x437;&#x43e;&#x432;&#x430;&#x43d;&#x43d;&#x43e;&#x433;&#x43e; &#x43f;&#x440;&#x435;&#x434;&#x441;&#x442;&#x430;&#x432;&#x43b;&#x435;&#x43d;&#x438;&#x44f;</h2>
<p>&#x414;&#x43b;&#x44f; &#x432;&#x43e;&#x441;&#x441;&#x442;&#x430;&#x43d;&#x43e;&#x432;&#x43b;&#x435;&#x43d;&#x438;&#x44f; &#x431;&#x430;&#x439;&#x442;-&#x43a;&#x43e;&#x434;&#x430; &#x438;&#x437; &#x441;&#x435;&#x440;&#x438;&#x430;&#x43b;&#x438;&#x437;&#x43e;&#x432;&#x430;&#x43d;&#x43d;&#x43e;&#x433;&#x43e; &#x43f;&#x440;&#x435;&#x434;&#x441;&#x442;&#x430;&#x432;&#x43b;&#x435;&#x43d;&#x438;&#x44f; &#x438;&#x441;&#x43f;&#x43e;&#x43b;&#x44c;&#x437;&#x443;&#x435;&#x442;&#x441;&#x44f; &#x43a;&#x43b;&#x430;&#x441;&#x441; <code>xyz.cofe.trambda.MethodRestore</code></p>

<div class="source">
<div class="source"><pre class="prettyprint">var byteCode = new MethodRestore()
     // &#x418;&#x43c;&#x44f; &#x446;&#x435;&#x43b;&#x435;&#x432;&#x43e;&#x433;&#x43e; &#x43a;&#x43b;&#x430;&#x441;&#x441;&#x430;
    .className(&quot;xyz.cofe.trambda.buildMethodTest.Build1&quot;)
    // &#x418;&#x43c;&#x44f; &#x446;&#x435;&#x43b;&#x435;&#x432;&#x43e;&#x433;&#x43e; &#x43c;&#x435;&#x442;&#x43e;&#x434;&#x430;
    .methodName(&quot;lambda1&quot;)
    // &#x421;&#x435;&#x440;&#x438;&#x430;&#x43b;&#x438;&#x437;&#x43e;&#x432;&#x430;&#x43d;&#x43d;&#x430;&#x44f; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x430;
    .methodDef(mdef)
    // &#x413;&#x435;&#x43d;&#x435;&#x440;&#x430;&#x446;&#x438;&#x44f; &#x431;&#x430;&#x439;&#x442; &#x43a;&#x43e;&#x434;&#x430;
    .generate();
</pre></div></div>

<p>&#x417;&#x430;&#x442;&#x435;&#x43c; &#x43c;&#x43e;&#x436;&#x43d;&#x43e; &#x434;&#x43b;&#x44f; &#x44d;&#x442;&#x43e;&#x433;&#x43e; &#x431;&#x430;&#x439;&#x442;&#x43a;&#x43e;&#x434;&#x430;, &#x447;&#x435;&#x440;&#x435;&#x437; &#x441;&#x43e;&#x431;&#x441;&#x442;&#x432;&#x435;&#x43d;&#x43d;&#x44b;&#x439; &#x437;&#x430;&#x433;&#x440;&#x443;&#x437;&#x447;&#x438;&#x43a; &#x43a;&#x43b;&#x430;&#x441;&#x441;&#x43e;&#x432;, &#x43f;&#x43e;&#x43b;&#x443;&#x447;&#x438;&#x442;&#x44c; &#x441;&#x441;&#x44b;&#x43b;&#x43a;&#x443; (<a class="externalLink" href="https://docs.oracle.com/javase/8/docs/api/java/lang/reflect/Method.html">java.lang.reflect.Method</a>) &#x43d;&#x430; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x443;:</p>

<div class="source">
<div class="source"><pre class="prettyprint">// &#x421;&#x43e;&#x437;&#x434;&#x430;&#x435;&#x43c; &#x441;&#x432;&#x43e;&#x439; Classloader, 
// &#x447;&#x435;&#x440;&#x435;&#x437; &#x43a;&#x43e;&#x442;&#x43e;&#x440;&#x44b;&#x439; &#x431;&#x443;&#x434;&#x435;&#x43c; &#x437;&#x430;&#x433;&#x440;&#x443;&#x436;&#x430;&#x442;&#x44c; &#x43d;&#x430;&#x448; &#x441;&#x433;&#x435;&#x43d;&#x435;&#x43d;&#x438;&#x440;&#x43e;&#x432;&#x430;&#x43d;&#x44b;&#x439; &#x43a;&#x43b;&#x430;&#x441;&#x441;
ClassLoader cl = new ClassLoader(ClassLoader.getSystemClassLoader()) {
    @Override
    protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException{
        if( name!=null &amp;&amp; 
            name.equals(&quot;xyz.cofe.trambda.buildMethodTest.Build1&quot;) 
        ){
            // &#x41f;&#x435;&#x440;&#x435;&#x434;&#x430;&#x447;&#x430; &#x431;&#x430;&#x439;&#x442;-&#x43a;&#x43e;&#x434;&#x430; &#x432; JVM
            return defineClass(name,byteCode,0,byteCode.length);
        }
        return super.findClass(name);
    }
};

Class c = null;
try{
    // &#x417;&#x430;&#x433;&#x440;&#x443;&#x437;&#x43a;&#x430; &#x43a;&#x43b;&#x430;&#x441;&#x441;&#x430; &#x438;&#x437; Classloader
    c = Class.forName(&quot;xyz.cofe.trambda.buildMethodTest.Build1&quot;,true,cl);
} catch( ClassNotFoundException e ) {
    e.printStackTrace();
    return;
}

// &#x418;&#x449;&#x435;&#x43c; &#x446;&#x435;&#x43b;&#x435;&#x432;&#x43e;&#x439; &#x43c;&#x435;&#x442;&#x43e;&#x434;, &#x43e;&#x43d; &#x43f;&#x43e; &#x443;&#x43c;&#x43e;&#x43b;&#x447;&#x430;&#x43d;&#x438;&#x44e; &#x434;&#x43e;&#x43b;&#x436;&#x435;&#x43d; &#x431;&#x44b;&#x442;&#x44c; static
Method m = null;
for( var delMeth : c.getDeclaredMethods() ){
    if( delMeth.getName().equals(&quot;lambda1&quot;) ){
        // &#x41d;&#x430;&#x439;&#x434;&#x435;&#x43d; &#x43c;&#x435;&#x442;&#x43e;&#x434; &#x43a;&#x43e;&#x442;&#x43e;&#x440;&#x44b;&#x439; &#x440;&#x435;&#x430;&#x43b;&#x438;&#x437;&#x443;&#x435;&#x442; &#x43b;&#x44f;&#x43c;&#x431;&#x434;&#x443;
        m = delMeth;
    }
}
</pre></div></div>
</section><section>
<h2><a name="a.D0.A4.D1.83.D0.BD.D0.BA.D1.86.D0.B8.D0.B8_.D0.BF.D1.80.D0.BE.D0.B2.D0.B5.D1.80.D0.BA.D0.B8_.D0.B1.D0.B5.D0.B7.D0.BE.D0.BF.D0.B0.D1.81.D0.BD.D0.BE.D1.81.D1.82.D0.B8_.D0.B1.D0.B0.D0.B9.D1.82-.D0.BA.D0.BE.D0.B4.D0.B0"></a>&#x424;&#x443;&#x43d;&#x43a;&#x446;&#x438;&#x438; &#x43f;&#x440;&#x43e;&#x432;&#x435;&#x440;&#x43a;&#x438; &#x431;&#x435;&#x437;&#x43e;&#x43f;&#x430;&#x441;&#x43d;&#x43e;&#x441;&#x442;&#x438; &#x431;&#x430;&#x439;&#x442;-&#x43a;&#x43e;&#x434;&#x430;</h2>
<p>&#x420;&#x435;&#x430;&#x43b;&#x438;&#x437;&#x43e;&#x432;&#x430;&#x43d;&#x430; &#x441;&#x43b;&#x435;&#x434;&#x443;&#x44e;&#x449;&#x430;&#x44f; &#x43f;&#x440;&#x43e;&#x432;&#x435;&#x440;&#x43a;&#x430;</p>
<ul>

<li>&#x41f;&#x440;&#x43e;&#x432;&#x435;&#x440;&#x43a;&#x430; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x430; &#x43c;&#x435;&#x442;&#x43e;&#x434;&#x430;</li>
<li>&#x41f;&#x440;&#x43e;&#x432;&#x435;&#x440;&#x43a;&#x430; &#x447;&#x442;&#x435;&#x43d;&#x438;&#x44f;/&#x437;&#x430;&#x43f;&#x438;&#x441;&#x438; &#x432; &#x43f;&#x43e;&#x43b;&#x44f; &#x43a;&#x43b;&#x430;&#x441;&#x441;&#x430; (field)</li>
</ul>

<div class="source">
<div class="source"><pre class="prettyprint">import xyz.cofe.trambda.sec.SecurityFilters;
import xyz.cofe.trambda.sec.SecurityFilter;
import xyz.cofe.trambda.sec.SecurAccess;

var secAcc = SecurAccess.inspect(mdef);

var sfilters = SecurityFilters.create()
    // &#x420;&#x430;&#x437;&#x440;&#x435;&#x448;&#x430;&#x435;&#x43c; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x44b;
    .allow(a -&gt; {
        // Java &#x43a;&#x43e;&#x43c;&#x43f;&#x438;&#x43b;&#x44f;&#x442;&#x43e;&#x440; &#x433;&#x435;&#x43d;&#x435;&#x440;&#x438;&#x440;&#x443;&#x435;&#x442; &#x432; &#x431;&#x430;&#x439;&#x442; &#x43a;&#x43e;&#x434;&#x435; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x44b;
        // &#x43c;&#x435;&#x442;&#x43e;&#x434;&#x43e;&#x432; &#x443;&#x43a;&#x430;&#x437;&#x430;&#x43d;&#x43d;&#x44b;&#x445; &#x43a;&#x43b;&#x430;&#x441;&#x441;&#x43e;&#x432;
        a.invoke(&quot;Java compiler&quot;, call -&gt; 
            call.getOwner().equals(&quot;java.lang.invoke.StringConcatFactory&quot;));
        a.invoke(&quot;Java compiler&quot;, call -&gt; 
            call.getOwner().equals(&quot;java.lang.invoke.LambdaMetafactory&quot;));
    })
    // &#x420;&#x430;&#x437;&#x440;&#x435;&#x448;&#x430;&#x435;&#x43c; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x44b;
    .allow(a -&gt; {
        // &#x414;&#x43e;&#x441;&#x442;&#x443;&#x43f; &#x43a; stdio, &#x434;&#x43b;&#x44f; &#x447;&#x442;&#x435;&#x43d;&#x438;&#x44f;
        a.field(&quot;System stdio&quot;, f -&gt; 
            f.getOwner().equals(&quot;java.lang.System&quot;) &amp;&amp; f.isReadAccess());
        // &#x414;&#x43e;&#x441;&#x442;&#x443;&#x43f; &#x43a; java stream, java collection
        a.invoke(&quot;Java Streams&quot;, 
            f -&gt; f.getOwner().matches(&quot;java\\.io\\.[\\w\\d]*(Stream|Writer)[\\w\\d]*&quot;));
        // &#x414;&#x43e;&#x441;&#x442;&#x443;&#x43f; &#x43a; &#x43c;&#x435;&#x442;&#x43e;&#x434;&#x430;&#x43c; &#x43a;&#x43b;&#x430;&#x441;&#x441;&#x430; java.lang.String
        a.invoke(&quot;api Java lang&quot;, c -&gt; 
            c.getOwner().matches(&quot;java.lang.String&quot;));
    })
    // &#x417;&#x430;&#x43f;&#x440;&#x435;&#x449;&#x430;&#x435;&#x43c; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x44b;
    .deny(b -&gt; {
        // &#x417;&#x430;&#x43f;&#x440;&#x435;&#x449;&#x430;&#x435;&#x43c; &#x438;&#x437;&#x43c;&#x435;&#x43d;&#x44f;&#x442;&#x44c; &#x43f;&#x43e;&#x43b;&#x44f; out, err, in &#x43a;&#x43b;&#x430;&#x441;&#x441;&#x430; System
        b.field(&quot;deny System field write&quot;, 
            f -&gt; f.getOwner().equals(&quot;java.lang.System&quot;) &amp;&amp; f.isWriteAccess());
        
        // &#x417;&#x430;&#x43f;&#x440;&#x435;&#x449;&#x430;&#x435;&#x43c; &#x432;&#x44b;&#x437;&#x44b;&#x432;&#x430;&#x442;&#x44c; &#x447;&#x443;&#x432;&#x441;&#x442;&#x432;&#x438;&#x442;&#x435;&#x43b;&#x44c;&#x43d;&#x44b;&#x435; &#x43c;&#x435;&#x442;&#x43e;&#x434;&#x44b; &#x43a;&#x43b;&#x430;&#x441;&#x441;&#x430; System
        b.invoke(&quot;deny call System method&quot;, 
            f -&gt; f.getOwner().equals(&quot;java.lang.System&quot;) &amp;&amp; f.getMethodName().matches(
            &quot;(?i)gc|exit|console|clear.*|&quot; +
            &quot;getSecurity.*|inherited.*|load.*|map.*|run.*|set.*|wait.*&quot;));
    })
    // &#x420;&#x430;&#x437;&#x440;&#x435;&#x448;&#x430;&#x435;&#x43c; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x44b; &#x43d;&#x430;&#x448;&#x435;&#x433;&#x43e; &#x441;&#x435;&#x440;&#x432;&#x438;&#x441;&#x430;
    .allow( a -&gt; {
        a.invoke(&quot;api by xyz.cofe&quot;, c -&gt; c.getOwner().matches(&quot;xyz.cofe.iter.[\\w\\d]+&quot;));
        a.invoke(&quot;api by xyz.cofe&quot;, c -&gt; c.getOwner().matches(&quot;xyz.cofe.[\\w\\d]+&quot;));
        a.invoke(&quot;api by trambda&quot;, c -&gt; c.getOwner().matches(&quot;xyz.cofe.trambda.[\\w\\d]+&quot;));
    })
    // &#x417;&#x430;&#x43f;&#x440;&#x435;&#x449;&#x430;&#x435;&#x43c; &#x432;&#x441;&#x435; &#x43e;&#x441;&#x442;&#x430;&#x43b;&#x44c;&#x43d;&#x44b;&#x435; &#x432;&#x44b;&#x437;&#x43e;&#x432;&#x44b;
    .deny().any(&quot;Deny by default&quot;)
    .build();

// &#x412;&#x44b;&#x43f;&#x43e;&#x43b;&#x43d;&#x44f;&#x435;&#x43c; &#x43f;&#x440;&#x43e;&#x432;&#x435;&#x440;&#x43a;&#x443; &#x431;&#x430;&#x439;&#x442;-&#x43a;&#x43e;&#x434;&#x430;
sfilters.validate(secAcc).forEach(sm -&gt; System.out.println(
    &quot;allow=&quot;+sm.isAllow()+
    &quot; message=&quot;+sm.getMessage()+
    &quot; access=&quot;+sm.getAccess()
    ));
</pre></div></div></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
All rights reserved.
        </div>
      </div>
    </footer>
  </body>
</html>
